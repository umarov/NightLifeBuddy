PrimeFaces.widget.ScrollPanel=PrimeFaces.widget.DeferredWidget.extend({init:function(a){this.cfg=a;this.id=this.cfg.id;if(this.id){this.jqId=PrimeFaces.escapeClientId(this.id);this.jq=$(this.jqId)}else{this.jq=this.cfg.jq}if(this.cfg.mode!=="native"){this.renderDeferred()}this.removeScriptElement(this.id)},_render:function(){this.jq.wrapInner('<div style="display:inline-block;"/>');this.content=this.jq.children("div");var g=this.jq.width(),j=this.jq.height(),a=this.content.outerWidth(true),h=this.content.outerHeight(true),f=a>g,d=h>j;if(!(f||d)){this.content.replaceWith(this.content.html());return}this.generateDOM();this.container.css({width:g,height:j});var e=this.container.children(".ui-scrollpanel-hbar"),i=this.container.children(".ui-scrollpanel-vbar"),c=g-(d?i.width():0),b=j-(f?e.height():0);this.wrapper.css({width:c,height:b});if(f){this.h={bar:e,hand:e.children(".ui-scrollpanel-handle"),grip:e.find(".ui-scrollpanel-handle > span.ui-icon-grip-solid-vertical"),up:e.children(".ui-scrollpanel-bl"),down:e.children(".ui-scrollpanel-br"),wlen:c,diff:a-c,dir:"x"};this.initScroll(this.h)}if(d){this.v={bar:i,hand:i.children(".ui-scrollpanel-handle"),grip:i.find(".ui-scrollpanel-handle > span.ui-icon-grip-solid-horizontal"),up:i.children(".ui-scrollpanel-bt"),down:i.children(".ui-scrollpanel-bb"),wlen:b,diff:h-b,dir:"y"};this.initScroll(this.v)}return true},generateDOM:function(){this.jq.wrapInner('<div class="ui-scrollpanel-container" />');this.container=this.jq.children(".ui-scrollpanel-container");this.container.wrapInner('<div class="ui-scrollpanel-wrapper" />');this.wrapper=this.container.children(".ui-scrollpanel-wrapper");this.content.removeAttr("style").addClass("ui-scrollpanel-content");var b='<div class="ui-scrollpanel-hbar ui-widget-header ui-corner-bottom">';b+='<div class="ui-scrollpanel-handle ui-state-default ui-corner-all"><span class="ui-icon ui-icon-grip-solid-vertical"></span></div>';b+='<div class="ui-scrollpanel-bl ui-state-default ui-corner-bl"><span class="ui-icon ui-icon-triangle-1-w"></span></div>';b+='<div class="ui-scrollpanel-br ui-state-default ui-corner-br"><span class="ui-icon ui-icon-triangle-1-e"></span></div></div>';var a='<div class="ui-scrollpanel-vbar ui-widget-header ui-corner-bottom">';a+='<div class="ui-scrollpanel-handle ui-state-default ui-corner-all"><span class="ui-icon ui-icon-grip-solid-horizontal"></span></div>';a+='<div class="ui-scrollpanel-bt ui-state-default ui-corner-bl"><span class="ui-icon ui-icon-triangle-1-n"></span></div>';a+='<div class="ui-scrollpanel-bb ui-state-default ui-corner-br"><span class="ui-icon ui-icon-triangle-1-s"></span></div></div>';this.container.append(b);this.container.append(a)},initScroll:function(b){b.bar.css({display:"block"});if(b.dir==="x"){var a=b.wlen-b.up.outerWidth(true)-b.down.outerWidth(true),c=a-b.hand.outerWidth(true);b.bar.css({width:a});b.upLen=parseFloat(b.up.outerWidth(true));if(c>b.diff){b.scrollable=b.diff;b.controller=b.diff;b.ratio=1;b.hand.outerWidth((a-b.diff));b.grip.css("margin-left",(b.hand.innerWidth()-b.grip.outerWidth(true))/2)}else{b.scrollable=c;b.controller=c;b.ratio=b.diff/c}}else{var d=b.wlen-b.up.outerHeight(true)-b.down.outerHeight(true),c=d-b.hand.outerHeight(true);b.bar.css({height:d});b.upLen=parseFloat(b.up.outerHeight(true));if(c>b.diff){b.scrollable=b.diff;b.controller=b.diff;b.ratio=1;b.hand.outerHeight((d-b.diff));b.grip.css("margin-top",(b.hand.innerHeight()-b.grip.outerHeight(true))/2)}else{b.scrollable=c;b.controller=c;b.ratio=b.diff/c}}this.bindEvents(b)},bindEvents:function(f){var c=f,b=this;$.each([c.hand,c.up,c.down],function(h,j){j.mouseover(function(){$(this).addClass("ui-state-hover")}).mouseout(function(){$(this).removeClass("ui-state-hover")}).mouseup(function(){$(this).removeClass("ui-state-active")}).mousedown(function(){$(this).addClass("ui-state-active")})});this.wrapper.bind("mousewheel",function(i,h){if(b.scrollWithRatio("y",h,true)){i.preventDefault()}});c.bar.bind("mousewheel",function(i,h){b.scrollWithRatio(c.dir,h,true);i.preventDefault()});var e=undefined;c.hand.draggable({axis:c.dir,drag:function(j,h){var i=h.position;e=e||i;if(c.dir==="x"){b.scrollWithRatio("x",e.left-i.left)}else{b.scrollWithRatio("y",e.top-i.top)}e=i},containment:"parent",scroll:false,stop:function(h){$(h.target).removeClass("ui-state-active")}});var d,a=false,g=0;c.up.mousedown(function(h){a=true;g=0;d=setInterval(function(){g++;b.scrollWithRatio(c.dir,2,true)},10);h.preventDefault()}).mouseenter(function(){if(a){$(this).mousedown()}}).mouseup(function(){a=false;clearInterval(d)}).mouseleave(function(){clearInterval(d);$(this).removeClass("ui-state-active")}).click(function(){if(g<5){b.scrollWithRatio(c.dir,20,true)}});c.down.mousedown(function(h){a=true;g=0;d=setInterval(function(){g++;b.scrollWithRatio(c.dir,-2,true)},10);h.preventDefault()}).mouseenter(function(){if(a){$(this).mousedown()}}).mouseup(function(){a=false;clearInterval(d)}).mouseleave(function(){clearInterval(d);$(this).removeClass("ui-state-active")}).click(function(){if(g<5){b.scrollWithRatio(c.dir,-20,true)}});$(document.body).bind("mouseup.scrollpanel",function(){clearInterval(d);c.hand.removeClass("ui-state-active");a=false})},scrollTo:function(a,b){this.scrollX(a);this.scrollY(b)},scrollToRatio:function(a,c,b){this.scrollWithRatio("x",a,b===false?false:true);this.scrollWithRatio("y",c,b===false?false:true)},checkScrollable:function(b,a){if(b&&a){if(b.controller+a<0){return -b.controller}else{if(b.controller+a>b.scrollable){return b.scrollable-b.controller}else{return a}}}return 0},scrollWithRatio:function(e,g,c){if(e==="x"){g=this.checkScrollable(this.h,g);if(!g){return false}this.h.controller+=g;var b=this.h.scrollable-this.h.controller,f=-b*this.h.ratio;this.content.css({left:f});if(c){this.h.hand.css({left:this.h.upLen+b})}}else{g=this.checkScrollable(this.v,g);if(!g){return false}this.v.controller+=g;var b=this.v.scrollable-this.v.controller,a=-b*this.v.ratio;this.content.css({top:a});if(c){this.v.hand.css({top:this.v.upLen+b})}}return true},scrollX:function(a){this.content.css({left:typeof(a)=="string"?a:-a})},scrollY:function(a){this.content.css({top:typeof(a)=="string"?a:-a})}});